{% extends "base.html" %}
{% block content %}
<div class="row g-3">
  <!-- Contacts Table -->
  <div class="col-12 col-lg-8">
    <div class="card glass shadow-sm p-3 contacts-card">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">Contacts</h5>
        <div class="d-flex gap-2">
          <button class="btn btn-sm btn-light" id="btn-refresh"><i class="fa-solid fa-arrows-rotate"></i></button>
          <a class="btn btn-sm btn-outline-light" href="{{ url_for('recycle_bin') }}"><i class="fa-solid fa-trash"></i> Recycle Bin</a>
        </div>
      </div>
      <div class="mb-3 d-flex gap-2">
        <input id="search-input" type="text" class="form-control" placeholder="Search name or number..." value="{{ q }}" oninput="filterTable()">
        <button class="btn btn-primary" onclick="document.getElementById('addModal').classList.add('show')">Add</button>
      </div>
      <div class="table-responsive">
        <table id="contacts-table" class="table table-borderless text-white align-middle">
          <thead class="text-muted small">
            <tr><th style="width:45%">Name</th><th style="width:35%">Number</th><th style="width:20%" class="text-end">Actions</th></tr>
          </thead>
          <tbody>
            {% if contacts %}
              {% for c in contacts %}
              <tr class="table-row-anim">
                <td>{{ c.name }}</td>
                <td>{{ c.number }}</td>
                <td class="text-end">
                  <form class="d-inline" method="post" action="{{ url_for('delete') }}">
                    <input type="hidden" name="key" value="{{ c.name }}">
                    <button class="btn btn-sm btn-danger" type="submit"><i class="fa-solid fa-trash-can"></i></button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            {% else %}
              <tr><td colspan="3" class="text-center text-muted">No contacts found.</td></tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Quick Add & Actions -->
  <div class="col-12 col-lg-4">
    <div class="card glass shadow-sm p-3 h-100 d-flex flex-column justify-content-between">
      <div>
        <h6>Quick Add</h6>
        <form method="post" action="{{ url_for('add') }}" class="d-flex flex-column gap-2">
          <input type="text" name="name" class="form-control" placeholder="Name" required>
          <input type="text" name="number" class="form-control" placeholder="Number" required>
          <div class="d-flex gap-2">
            <button class="btn btn-success w-100" type="submit"><i class="fa-solid fa-plus"></i> Add Contact</button>
          </div>
        </form>
      </div>
      <div class="mt-3 text-center small text-muted">Tip: Use the add form to quickly add contacts. Deleted contacts go to Recycle Bin.</div>
    </div>

    <div class="card glass shadow-sm p-3 mt-3">
      <h6 class="mb-2">Actions</h6>
      <form method="post" action="{{ url_for('delete') }}" class="d-flex gap-2 mb-2">
        <input type="text" name="key" class="form-control" placeholder="Name or Number to delete" required>
        <button class="btn btn-outline-danger" type="submit">Delete</button>
      </form>
      <form method="get" action="{{ url_for('index') }}" class="d-flex gap-2">
        <input name="q" type="text" class="form-control" placeholder="Search..." value="{{ q }}">
        <button class="btn btn-outline-primary" type="submit">Search</button>
      </form>
    </div>
  </div>
</div>

<!-- Add Contact Modal -->
<div id="addModal" class="modal" tabindex="-1" style="display:none;" onclick="closeModal(event)">
  <div class="modal-dialog modal-sm modal-dialog-centered">
    <div class="modal-content glass text-white">
      <div class="modal-header">
        <h5 class="modal-title">Add Contact</h5>
        <button type="button" class="btn-close" onclick="document.getElementById('addModal').classList.remove('show')"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="{{ url_for('add') }}" id="modalAddForm" class="d-flex flex-column gap-2">
          <input type="text" name="name" class="form-control" placeholder="Name" required>
          <input type="text" name="number" class="form-control" placeholder="Number" required>
          <div class="d-grid mt-2">
            <button class="btn btn-primary" type="submit">Add</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
